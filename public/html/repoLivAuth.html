<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Inscription & Connexion - Responsable Livraison</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    />
    <style>
      body {
        background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%);
        font-family: "Montserrat", sans-serif;
        min-height: 100vh;
        margin: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
      }
      .container {
        background: #fff;
        border-radius: 22px;
        box-shadow: 0 12px 40px rgba(30, 60, 114, 0.18);
        padding: 1rem 1.1rem 1.1rem 1.1rem;
        width: 100%;
        max-width: 420px;
        position: relative;
        overflow: visible;
        transition: box-shadow 0.3s;
        z-index: 2;
        min-height: unset;
      }
      .container:hover {
        box-shadow: 0 18px 60px rgba(30, 60, 114, 0.22);
      }
      .form-illustration {
        width: 65px;
        height: 65px;
        display: block;
        margin: 0 auto 0.5rem auto;
        border-radius: 50%;
        box-shadow: 0 4px 18px rgba(30, 60, 114, 0.13);
        object-fit: cover;
        background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
        padding: 6px;
        animation: truckMove 1.7s ease-in-out infinite;
      }
      @keyframes truckMove {
        0% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(12px);
        }
        100% {
          transform: translateY(0);
        }
      }
      .tabs {
        display: flex;
        justify-content: space-between;
        margin-bottom: 2rem;
        background: #f0f4fa;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(30, 60, 114, 0.08);
        overflow: hidden;
      }
      .tab {
        flex: 1;
        text-align: center;
        padding: 0.9rem 0;
        cursor: pointer;
        font-weight: 700;
        color: #1e3c72;
        border-bottom: 2px solid transparent;
        transition: border 0.2s, color 0.2s, background 0.2s;
        letter-spacing: 1px;
        background: none;
        font-size: 1.08rem;
      }
      .tab.active {
        color: #fff;
        background: linear-gradient(90deg, #1e3c72 0%, #2a5298 100%);
        border-bottom: 2.5px solid #1e3c72;
        border-radius: 12px 12px 0 0;
        box-shadow: 0 2px 8px rgba(30, 60, 114, 0.08);
      }
      form {
        display: none;
        flex-direction: column;
        gap: 1rem;
        animation: fadeIn 0.5s;
        max-height: none;
      }
      form.active {
        display: flex;
      }
      .form-group {
        display: flex;
        flex-direction: column;
        gap: 0.3rem;
        position: relative;
      }
      label {
        font-size: 1.08rem;
        color: #1e3c72;
        font-weight: 700;
        margin-bottom: 0.2rem;
        letter-spacing: 0.5px;
      }
      input[type="text"],
      input[type="email"],
      input[type="password"] {
        padding: 0.85rem 1.1rem 0.85rem 2.7rem;
        border: 2px solid #e3ecfa;
        border-radius: 10px;
        font-size: 1.08rem;
        background: #f7faff;
        transition: border 0.2s, box-shadow 0.2s;
        outline: none;
        box-shadow: 0 2px 8px rgba(30, 60, 114, 0.07);
      }
      input:focus {
        border: 2px solid #1e3c72;
        background: #e3ecfa;
        box-shadow: 0 4px 16px rgba(30, 60, 114, 0.13);
      }
      .input-icon {
        position: absolute;
        left: 1rem;
        top: 50%;
        transform: translateY(-50%);
        color: #1e3c72;
        font-size: 1.15rem;
        opacity: 0.8;
      }
      .btn {
        background: linear-gradient(90deg, #1e3c72 0%, #2a5298 100%);
        color: #fff;
        border: none;
        border-radius: 10px;
        padding: 1rem 0;
        font-size: 1.15rem;
        font-weight: 700;
        cursor: pointer;
        margin-top: 0.5rem;
        box-shadow: 0 4px 16px rgba(30, 60, 114, 0.13);
        transition: background 0.2s, box-shadow 0.2s, transform 0.2s;
        letter-spacing: 1px;
      }
      .btn:hover {
        background: linear-gradient(90deg, #2a5298 0%, #1e3c72 100%);
        box-shadow: 0 8px 32px rgba(30, 60, 114, 0.18);
        transform: translateY(-2px) scale(1.03);
      }
      .message {
        margin-top: 0.5rem;
        font-size: 1.05rem;
        text-align: center;
        color: #e74c3c;
        min-height: 1.2em;
        font-weight: 600;
      }
      .success {
        color: #27ae60;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .show-password {
        position: absolute;
        right: 1.2rem;
        top: 50%;
        transform: translateY(-50%);
        cursor: pointer;
        color: #b0b8c1;
        font-size: 1.15rem;
        z-index: 2;
      }
      .form-group.password-group {
        position: relative;
      }
      @media (max-width: 1200px) {
        .container {
          max-width: 520px;
          padding: 2rem 1.5rem 1.5rem 1.5rem;
        }
      }
      @media (max-width: 900px) {
        .container {
          max-width: 97vw;
          padding: 2rem 1.2rem 1.2rem 1.2rem;
        }
        .tabs {
          margin-bottom: 1.2rem;
        }
        .tab {
          font-size: 1.03rem;
          padding: 0.7rem 0;
        }
        label {
          font-size: 1.03rem;
        }
        input[type="text"],
        input[type="email"],
        input[type="password"] {
          font-size: 1.03rem;
          padding: 0.7rem 0.8rem 0.7rem 2.2rem;
        }
        .btn {
          font-size: 1.08rem;
          padding: 0.8rem 0;
        }
      }
      @media (max-width: 600px) {
        body {
          align-items: flex-start;
          padding-top: 2.5vw;
        }
        .container {
          max-width: 99vw;
          min-width: 0;
          padding: 1.2rem 0.5rem 1.2rem 0.5rem;
          border-radius: 14px;
          box-shadow: 0 4px 18px rgba(255, 193, 7, 0.13);
        }
        .tabs {
          margin-bottom: 0.7rem;
        }
        .tab {
          font-size: 0.99rem;
          padding: 0.6rem 0;
        }
        form {
          gap: 0.7rem;
        }
        .form-group {
          gap: 0.15rem;
        }
        label {
          font-size: 0.98rem;
        }
        input[type="text"],
        input[type="email"],
        input[type="password"] {
          font-size: 0.98rem;
          padding: 0.6rem 0.6rem 0.6rem 1.7rem;
        }
        .btn {
          font-size: 1rem;
          padding: 0.7rem 0;
        }
        .show-password {
          right: 0.7rem;
          font-size: 1.08rem;
        }
      }
      @media (min-width: 1600px) {
        .container {
          max-width: 600px;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <img
        src="https://cdn-icons-png.flaticon.com/512/1048/1048953.png"
        alt="Icône camion de livraison"
        class="form-illustration"
      />
      <h2
        style="
          text-align: center;
          color: #ff9800;
          font-size: 2.1rem;
          font-weight: 900;
          margin-bottom: 1.7rem;
          margin-top: 0.2rem;
          letter-spacing: 2px;
          text-shadow: 0 2px 8px rgba(255, 193, 7, 0.18), 0 1px 0 #fff;
        "
      >
        Espace Responsable de Livraison
      </h2>
      <!-- Avatar bleu + dropdown profil -->
      <div
        class="d-flex flex-column align-items-end flex-shrink-0"
        style="min-width: 60px; position: relative; margin-bottom: 18px"
      >
        <div
          id="profileAvatar"
          style="
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #e0e7ef;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px #2563eb22;
            cursor: pointer;
            position: relative;
          "
        >
          <i
            class="fas fa-user"
            id="mainAvatarIcon"
            style="font-size: 2.1em; color: #2563eb"
          ></i>
          <img
            id="mainAvatarPhoto"
            src=""
            alt="Photo de profil"
            style="
              display: none;
              width: 100%;
              height: 100%;
              object-fit: cover;
              position: absolute;
              top: 0;
              left: 0;
              border-radius: 50%;
              z-index: 1;
            "
          />
        </div>
        <div
          id="profileDropdown"
          style="
            display: none;
            position: absolute;
            top: 76px;
            right: 0;
            min-width: 220px;
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(30, 41, 59, 0.18);
            padding: 18px 20px;
            z-index: 1001;
          "
        >
          <div
            style="
              display: flex;
              align-items: center;
              justify-content: center;
              margin-bottom: 10px;
              position: relative;
            "
          >
            <span
              id="profilePhotoCircle"
              style="
                display: inline-flex;
                align-items: center;
                justify-content: center;
                width: 48px;
                height: 48px;
                border-radius: 50%;
                background: linear-gradient(135deg, #2563eb 60%, #1e293b 100%);
                box-shadow: 0 2px 8px #2563eb22;
                overflow: hidden;
                cursor: pointer;
                position: relative;
              "
            >
              <i
                class="fas fa-camera"
                id="cameraIcon"
                style="font-size: 1.5em; color: #fff; z-index: 2"
              ></i>
              <img
                id="profilePhotoPreview"
                src=""
                alt="Photo de profil"
                style="
                  display: none;
                  width: 100%;
                  height: 100%;
                  object-fit: cover;
                  position: absolute;
                  top: 0;
                  left: 0;
                  z-index: 1;
                "
              />
              <button
                id="removePhotoBtn"
                title="Supprimer la photo"
                style="
                  display: none;
                  position: absolute;
                  top: 2px;
                  right: 2px;
                  width: 22px;
                  height: 22px;
                  border-radius: 50%;
                  background: #fff;
                  border: none;
                  box-shadow: 0 1px 4px #2563eb22;
                  z-index: 3;
                  align-items: center;
                  justify-content: center;
                  padding: 0;
                  cursor: pointer;
                "
              >
                <i
                  class="fas fa-times"
                  style="color: #2563eb; font-size: 1em"
                ></i>
              </button>
            </span>
            <input
              type="file"
              id="profilePhotoInput"
              accept="image/*"
              style="display: none"
            />
          </div>
          <div
            id="profileName"
            style="font-weight: 600; font-size: 1.08em; color: #0e274e"
          >
            Nom de l'utilisateur
          </div>
          <div id="profileEmail" style="font-size: 0.98em; color: #64748b">
            email@exemple.com
          </div>
        </div>
      </div>
      <div class="tabs">
        <div class="tab active" id="tab-signup">Inscription</div>
        <div class="tab" id="tab-login">Connexion</div>
      </div>
      <form id="signup-form" class="active" autocomplete="off">
        <div class="form-group">
          <span class="input-icon"><i class="fa fa-user"></i></span>
          <label for="signup-nom">Nom complet</label>
          <input
            type="text"
            id="signup-nom"
            name="nom"
            placeholder="Votre nom complet"
            required
          />
        </div>
        <div class="form-group">
          <span class="input-icon"><i class="fa fa-envelope"></i></span>
          <label for="signup-email">Email</label>
          <input
            type="email"
            id="signup-email"
            name="email"
            placeholder="Votre email"
            required
          />
        </div>
        <div class="form-group password-group">
          <span class="input-icon"><i class="fa fa-lock"></i></span>
          <label for="signup-password">Mot de passe</label>
          <input
            type="password"
            id="signup-password"
            name="password"
            placeholder="Mot de passe"
            required
          />
          <span
            class="show-password"
            onclick="togglePassword('signup-password', this)"
            ><i class="fa fa-eye"></i
          ></span>
        </div>
        <button type="submit" class="btn">S'inscrire</button>
        <div class="message" id="signup-message"></div>
      </form>
      <form id="login-form">
        <div class="form-group">
          <span class="input-icon"><i class="fa fa-envelope"></i></span>
          <label for="login-email">Email</label>
          <input
            type="email"
            id="login-email"
            name="email"
            placeholder="Votre email"
            required
          />
        </div>
        <div class="form-group password-group">
          <span class="input-icon"><i class="fa fa-lock"></i></span>
          <label for="login-password">Mot de passe</label>
          <input
            type="password"
            id="login-password"
            name="password"
            placeholder="Mot de passe"
            required
          />
          <span
            class="show-password"
            onclick="togglePassword('login-password', this)"
            ><i class="fa fa-eye"></i
          ></span>
        </div>
        <button type="submit" class="btn">Se connecter</button>
        <div class="message" id="login-message"></div>
        <div style="text-align: right; margin-top: 0.5rem">
          <a
            href="#"
            id="forgot-link"
            style="
              color: #1e3c72;
              font-size: 1.05rem;
              text-decoration: underline;
              font-weight: 600;
            "
            >Mot de passe oublié ?</a
          >
        </div>
      </form>
      <!-- Popup mot de passe oublié -->
      <div
        id="forgot-popup"
        style="
          display: none;
          position: fixed;
          top: 0;
          left: 0;
          width: 100vw;
          height: 100vh;
          background: rgba(30, 60, 114, 0.13);
          z-index: 1000;
          align-items: center;
          justify-content: center;
        "
      >
        <div
          style="
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(30, 60, 114, 0.18);
            padding: 2rem 1.5rem;
            max-width: 350px;
            width: 90vw;
            margin: auto;
            position: relative;
          "
        >
          <span
            id="close-forgot"
            style="
              position: absolute;
              top: 10px;
              right: 14px;
              font-size: 1.3rem;
              color: #1e3c72;
              cursor: pointer;
            "
            >&times;</span
          >
          <h3
            style="
              color: #1e3c72;
              margin-bottom: 1.2rem;
              font-size: 1.15rem;
              text-align: center;
            "
          >
            Réinitialiser le mot de passe
          </h3>
          <form id="forgot-form" autocomplete="off">
            <div class="form-group">
              <span class="input-icon"><i class="fa fa-envelope"></i></span>
              <label for="forgot-email">Email</label>
              <input
                type="email"
                id="forgot-email"
                name="email"
                placeholder="Votre email"
                required
              />
            </div>
            <button type="submit" class="btn" style="width: 100%">
              Envoyer le lien de réinitialisation
            </button>
            <div class="message" id="forgot-message"></div>
          </form>
        </div>
      </div>
    </div>
    <script>
      // Avatar bleu : injection nom/email + dropdown
      document.addEventListener("DOMContentLoaded", function () {
        const userName =
          localStorage.getItem("user_nom") || localStorage.getItem("userName");
        const userEmail =
          localStorage.getItem("user_email") ||
          localStorage.getItem("userEmail");
        const avatarEl = document.getElementById("profileAvatar");
        const nameEl = document.getElementById("profileName");
        const emailEl = document.getElementById("profileEmail");
        if (userName && userEmail) {
          if (nameEl) nameEl.textContent = userName;
          if (emailEl) emailEl.textContent = userEmail;
          if (avatarEl) {
            let initials = userName
              .split(" ")
              .map((w) => w[0])
              .join("")
              .toUpperCase();
            if (initials.length > 2) initials = initials.slice(0, 2);
            let icon = avatarEl.querySelector("i.fas.fa-user");
            if (!icon) {
              icon = document.createElement("i");
              icon.className = "fas fa-user";
              icon.style.fontSize = "2.1em";
              icon.style.color = "#2563eb";
              avatarEl.appendChild(icon);
            }
            let initialsSpan = avatarEl.querySelector(".avatar-initials");
            if (!initialsSpan) {
              initialsSpan = document.createElement("span");
              initialsSpan.className = "avatar-initials";
              initialsSpan.style.position = "absolute";
              initialsSpan.style.right = "8px";
              initialsSpan.style.bottom = "8px";
              initialsSpan.style.fontSize = "1.1em";
              initialsSpan.style.fontWeight = "700";
              initialsSpan.style.color = "#2563eb";
              initialsSpan.style.background = "#fff";
              initialsSpan.style.borderRadius = "50%";
              initialsSpan.style.padding = "2px 7px";
              initialsSpan.style.boxShadow = "0 1px 4px #2563eb22";
              avatarEl.appendChild(initialsSpan);
            }
            initialsSpan.textContent = initials;
            avatarEl.style.position = "relative";
          }
        }
        // Dropdown profil au clic sur avatar
        const dropdown = document.getElementById("profileDropdown");
        if (avatarEl && dropdown) {
          avatarEl.onclick = function (e) {
            e.stopPropagation();
            dropdown.style.display =
              dropdown.style.display === "block" ? "none" : "block";
          };
          document.addEventListener("click", function (e) {
            if (!dropdown.contains(e.target) && e.target !== avatarEl) {
              dropdown.style.display = "none";
            }
          });
        }
      });
      // Tab switching
      document.getElementById("tab-signup").onclick = function () {
        this.classList.add("active");
        document.getElementById("tab-login").classList.remove("active");
        document.getElementById("signup-form").classList.add("active");
        document.getElementById("login-form").classList.remove("active");
      };
      document.getElementById("tab-login").onclick = function () {
        this.classList.add("active");
        document.getElementById("tab-signup").classList.remove("active");
        document.getElementById("login-form").classList.add("active");
        document.getElementById("signup-form").classList.remove("active");
      };
      // Affichage/masquage du mot de passes
      function togglePassword(id, el) {
        const input = document.getElementById(id);
        if (input.type === "password") {
          input.type = "text";
          el.innerHTML = '<i class="fa fa-eye-slash"></i>';
        } else {
          input.type = "password";
          el.innerHTML = '<i class="fa fa-eye"></i>';
        }
      }
      // Mot de passe oublié : ouverture popup
      document.getElementById("forgot-link").onclick = function (e) {
        e.preventDefault();
        document.getElementById("forgot-popup").style.display = "flex";
        document.getElementById("forgot-message").textContent = "";
      };
      document.getElementById("close-forgot").onclick = function () {
        document.getElementById("forgot-popup").style.display = "none";
      };
      // Envoi du formulaire mot de passe oublié
      document.getElementById("forgot-form").onsubmit = function (e) {
        e.preventDefault();
        var email = document.getElementById("forgot-email").value.trim();
        if (!email) return;
        document.getElementById("forgot-message").textContent =
          "Envoi en cours...";
        fetch("/api/forgot-password", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email }),
        })
          .then((r) => r.json())
          .then((data) => {
            if (data.success) {
              document.getElementById("forgot-message").textContent =
                "Un email de réinitialisation a été envoyé !";
              document
                .getElementById("forgot-message")
                .classList.add("success");
            } else {
              document.getElementById("forgot-message").textContent =
                data.message || "Erreur lors de l'envoi.";
              document
                .getElementById("forgot-message")
                .classList.remove("success");
            }
          })
          .catch(() => {
            document.getElementById("forgot-message").textContent =
              "Erreur serveur. Réessayez plus tard.";
            document
              .getElementById("forgot-message")
              .classList.remove("success");
          });
      };
      // Gestion du formulaire d'inscription
      document.getElementById("signup-form").onsubmit = function (e) {
        e.preventDefault();
        // Simule une inscription réussie
        document.getElementById("signup-message").textContent =
          "Inscription réussie ! Redirection vers la connexion...";
        document.getElementById("signup-message").classList.add("success");
        setTimeout(function () {
          document.getElementById("tab-login").click();
          document.getElementById("signup-message").textContent = "";
          document.getElementById("signup-message").classList.remove("success");
        }, 1200);
      };
      // Gestion du formulaire de connexion
      document.getElementById("login-form").onsubmit = function (e) {
        e.preventDefault();
        // Simule une connexion réussie
        document.getElementById("login-message").textContent =
          "Connexion réussie ! Redirection...";
        document.getElementById("login-message").classList.add("success");
        setTimeout(function () {
          // Récupère les valeurs du formulaire
          var email = document.getElementById("login-email").value.trim();
          var nom = "";
          // Si le champ nom existe dans le formulaire d'inscription et l'utilisateur vient de s'inscrire, on le récupère
          // Sinon, on laisse vide ou on peut le récupérer d'une API si besoin
          // Ici, on tente de récupérer le nom depuis localStorage si déjà inscrit
          if (localStorage.getItem("user_nom")) {
            nom = localStorage.getItem("user_nom");
          } else {
            nom = "";
          }
          // Si l'utilisateur vient de s'inscrire, on récupère le nom du formulaire d'inscription
          var signupNomInput = document.getElementById("signup-nom");
          if (signupNomInput && signupNomInput.value) {
            nom = signupNomInput.value.trim();
          }
          // Sauvegarde dans localStorage
          localStorage.setItem("user_email", email);
          localStorage.setItem("user_nom", nom);
          window.location.href =
            "https://plateformdesuivie-its-service-1cjx.onrender.com/html/resp_liv.html";
        }, 1200);
      };
    </script>
  </body>
</html>
<!--hqbv-->
