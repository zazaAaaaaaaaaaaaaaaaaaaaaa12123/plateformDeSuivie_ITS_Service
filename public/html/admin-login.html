<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Accès Administrateur - ITS Service</title>
    <!-- TAILWIND CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FONT AWESOME -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      .login-container {
        background: linear-gradient(
          135deg,
          #1e40af 0%,
          #3b82f6 50%,
          #60a5fa 100%
        );
        min-height: 100vh;
        padding: 1rem;
      }
      .login-card {
        backdrop-filter: blur(10px);
        background: rgba(255, 255, 255, 0.95);
        border: 1px solid rgba(255, 255, 255, 0.2);
        max-height: 95vh;
        overflow-y: auto;
      }
      .floating-shapes {
        position: absolute;
        width: 100%;
        height: 100%;
        overflow: hidden;
        z-index: 0;
      }
      .shape {
        position: absolute;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        animation: float 6s ease-in-out infinite;
      }
      .shape:nth-child(1) {
        width: 80px;
        height: 80px;
        top: 20%;
        left: 10%;
        animation-delay: 0s;
      }
      .shape:nth-child(2) {
        width: 120px;
        height: 120px;
        top: 60%;
        right: 10%;
        animation-delay: 2s;
      }
      .shape:nth-child(3) {
        width: 60px;
        height: 60px;
        top: 80%;
        left: 20%;
        animation-delay: 4s;
      }
      .shape:nth-child(4) {
        width: 100px;
        height: 100px;
        top: 10%;
        right: 30%;
        animation-delay: 1s;
      }
      @keyframes float {
        0%,
        100% {
          transform: translateY(0px) rotate(0deg);
        }
        33% {
          transform: translateY(-20px) rotate(120deg);
        }
        66% {
          transform: translateY(20px) rotate(240deg);
        }
      }
      .secure-badge {
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
        padding: 8px 20px;
        border-radius: 25px;
        font-size: 0.875rem;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        border: 2px solid rgba(255, 255, 255, 0.2);
        transition: all 0.3s ease;
      }
      .secure-badge:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
      }
      .input-field {
        transition: all 0.3s ease;
      }
      .input-field:focus {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
      }

      /* Styles pour les onglets */
      .tab-button {
        transition: all 0.3s ease;
        border-bottom-width: 2px;
      }
      .tab-button.active {
        color: #3b82f6;
        border-bottom-color: #3b82f6;
      }
      .tab-button:not(.active) {
        color: #6b7280;
        border-bottom-color: transparent;
      }
      .tab-button:not(.active):hover {
        color: #374151;
      }
      .tab-content.hidden {
        display: none;
      }

      /* Styles pour la barre de séparation */
      .separator-line {
        position: relative;
        overflow: hidden;
      }
      .separator-dot {
        animation: pulse 2s infinite;
      }
      .separator-glow {
        animation: glow 3s ease-in-out infinite alternate;
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 0.8;
          transform: scale(1);
        }
        50% {
          opacity: 1;
          transform: scale(1.1);
        }
      }

      @keyframes glow {
        0% {
          opacity: 0.4;
        }
        100% {
          opacity: 0.8;
        }
      }

      .input-field:focus {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(59, 130, 246, 0.2);
      }
    </style>
  </head>
  <body class="login-container flex items-center justify-center p-4">
    <!-- Formes flottantes animées -->
    <div class="floating-shapes">
      <div class="shape"></div>
      <div class="shape"></div>
      <div class="shape"></div>
      <div class="shape"></div>
    </div>

    <!-- Carte de connexion -->
    <div
      class="login-card rounded-2xl shadow-2xl p-0 w-full max-w-5xl relative z-10 overflow-hidden"
    >
      <!-- Layout principal avec séparation visible -->
      <div class="flex flex-col lg:flex-row min-h-[500px]">
        <!-- Colonne gauche - Header et informations -->
        <div
          class="lg:w-2/5 flex flex-col items-center justify-center text-center p-8 bg-gradient-to-br from-blue-50 via-indigo-50 to-blue-100 relative"
        >
          <!-- Motif décoratif en arrière-plan -->
          <div class="absolute inset-0 opacity-10">
            <div
              class="absolute top-4 right-4 w-16 h-16 bg-blue-400 rounded-full"
            ></div>
            <div
              class="absolute bottom-4 left-4 w-12 h-12 bg-indigo-400 rounded-full"
            ></div>
            <div
              class="absolute top-1/2 left-8 w-8 h-8 bg-blue-300 rounded-full"
            ></div>
          </div>
          <!-- Logo principal -->
          <div
            class="w-24 h-24 bg-gradient-to-br from-blue-600 to-blue-700 rounded-full flex items-center justify-center mb-6 shadow-xl border-4 border-white"
          >
            <i class="fas fa-shield-alt text-white text-3xl"></i>
          </div>

          <!-- Titre principal -->
          <h1
            class="text-3xl lg:text-4xl font-bold text-gray-800 mb-3 leading-tight"
          >
            Accès Administrateur
          </h1>

          <!-- Sous-titre -->
          <p class="text-gray-600 mb-6 text-lg font-medium">
            Gestion des Accès ITS Service
          </p>

          <!-- Badge de sécurité -->
          <div class="secure-badge inline-flex mb-8 px-6 py-2 text-base">
            <i class="fas fa-lock mr-2"></i>
            Connexion Sécurisée
          </div>

          <!-- Informations de sécurité -->
          <div class="space-y-4 w-full max-w-xs">
            <div
              class="flex items-center justify-center bg-green-50 rounded-lg p-3 border border-green-100"
            >
              <div
                class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center mr-3"
              >
                <i class="fas fa-shield-alt text-white text-sm"></i>
              </div>
              <span class="text-green-700 font-medium">Sécurisé</span>
            </div>

            <div
              class="flex items-center justify-center bg-blue-50 rounded-lg p-3 border border-blue-100"
            >
              <div
                class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center mr-3"
              >
                <i class="fas fa-lock text-white text-sm"></i>
              </div>
              <span class="text-blue-700 font-medium">Crypté</span>
            </div>

            <div
              class="flex items-center justify-center bg-gray-50 rounded-lg p-3 border border-gray-100"
            >
              <div
                class="w-8 h-8 bg-gray-500 rounded-full flex items-center justify-center mr-3"
              >
                <i class="fas fa-eye-slash text-white text-sm"></i>
              </div>
              <span class="text-gray-700 font-medium">Confidentiel</span>
            </div>
          </div>
        </div>

        <!-- Barre de séparation visible et élégante -->
        <div
          class="hidden lg:block w-6 bg-gradient-to-b from-blue-100 via-blue-300 to-blue-100 relative shadow-xl border-l border-r border-blue-200"
        >
          <!-- Ligne centrale principale -->
          <div
            class="absolute left-1/2 top-0 bottom-0 w-1 bg-gradient-to-b from-blue-400 via-blue-600 to-blue-400 transform -translate-x-1/2 rounded-full shadow-md"
          ></div>

          <!-- Lignes de guidage -->
          <div
            class="absolute left-2 top-0 bottom-0 w-0.5 bg-blue-200 opacity-60"
          ></div>
          <div
            class="absolute right-2 top-0 bottom-0 w-0.5 bg-blue-200 opacity-60"
          ></div>

          <!-- Décoration de la barre -->
          <div
            class="absolute top-1/4 left-1/2 transform -translate-x-1/2 w-3 h-3 bg-white rounded-full shadow-md opacity-80"
          ></div>
          <div
            class="absolute top-1/2 left-1/2 transform -translate-x-1/2 w-4 h-4 bg-white rounded-full shadow-lg border-2 border-blue-300"
          ></div>
          <div
            class="absolute top-3/4 left-1/2 transform -translate-x-1/2 w-3 h-3 bg-white rounded-full shadow-md opacity-80"
          ></div>

          <!-- Effet de lueur -->
          <div
            class="absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-20"
          ></div>
        </div>

        <!-- Colonne droite - Formulaires -->
        <div class="lg:w-3/5 p-8 bg-white relative">
          <!-- Onglets de navigation -->
          <div class="flex border-b border-gray-200 mb-4">
            <button
              type="button"
              onclick="switchTab('login')"
              id="loginTab"
              class="tab-button flex-1 py-3 px-4 text-center font-medium text-blue-600 border-b-2 border-blue-600"
            >
              <i class="fas fa-sign-in-alt mr-2"></i>Se Connecter
            </button>
            <button
              type="button"
              onclick="switchTab('register')"
              id="registerTab"
              class="tab-button flex-1 py-3 px-4 text-center font-medium text-gray-500 border-b-2 border-transparent hover:text-gray-700"
            >
              <i class="fas fa-user-plus mr-2"></i>S'Inscrire
            </button>
          </div>

          <!-- Formulaire de connexion -->
          <div id="loginForm" class="tab-content">
            <form id="adminLoginForm" class="space-y-4">
              <div>
                <label
                  for="adminEmail"
                  class="block text-sm font-medium text-gray-700 mb-2"
                >
                  <i class="fas fa-envelope mr-2 text-blue-600"></i>Email
                  Administrateur
                </label>
                <input
                  type="email"
                  id="adminEmail"
                  name="email"
                  class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"
                  placeholder="admin@itsservice.com"
                  required
                />
              </div>
              <div>
                <label
                  for="adminPassword"
                  class="block text-sm font-medium text-gray-700 mb-2"
                >
                  <i class="fas fa-key mr-2 text-blue-600"></i>Mot de Passe
                </label>
                <div class="relative">
                  <input
                    type="password"
                    id="adminPassword"
                    name="password"
                    class="input-field w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none"
                    placeholder="••••••••"
                    required
                  />
                  <button
                    type="button"
                    onclick="togglePassword('adminPassword')"
                    class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700"
                  >
                    <i class="fas fa-eye"></i>
                  </button>
                </div>
              </div>

              <!-- Message d'erreur -->
              <div
                id="loginErrorMessage"
                class="hidden bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm"
              >
                <i class="fas fa-exclamation-triangle mr-2"></i>
                <span id="loginErrorText"></span>
              </div>

              <!-- Message de chargement -->
              <div
                id="loginLoadingMessage"
                class="hidden bg-blue-50 border border-blue-200 text-blue-700 px-4 py-3 rounded-lg text-sm"
              >
                <i class="fas fa-spinner fa-spin mr-2"></i>
                Vérification des identifiants...
              </div>

              <!-- Bouton de connexion -->
              <button
                type="submit"
                id="loginButton"
                class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300 transform hover:scale-105 shadow-lg"
              >
                <i class="fas fa-sign-in-alt mr-2"></i>
                Se Connecter
              </button>

              <!-- Lien mot de passe oublié -->
              <div class="text-center mt-4 space-y-2">
                <button
                  type="button"
                  onclick="showForgotPasswordModal()"
                  class="text-blue-600 hover:text-blue-800 text-sm font-medium transition duration-300 block w-full"
                >
                  <i class="fas fa-question-circle mr-1"></i>Mot de passe oublié
                  ?
                </button>
                <button
                  type="button"
                  onclick="showResetPasswordModal()"
                  class="text-green-600 hover:text-green-800 text-sm font-medium transition duration-300 block w-full"
                >
                  <i class="fas fa-key mr-1"></i>J'ai reçu un code de
                  réinitialisation
                </button>
              </div>
            </form>
          </div>

          <!-- Formulaire d'inscription -->
          <div id="registerForm" class="tab-content hidden">
            <form id="adminRegisterForm" class="space-y-4">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label
                    for="registerName"
                    class="block text-sm font-medium text-gray-700 mb-2"
                  >
                    <i class="fas fa-user mr-2 text-green-600"></i>Nom Complet
                  </label>
                  <input
                    type="text"
                    id="registerName"
                    name="name"
                    class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 outline-none"
                    placeholder="Votre nom complet"
                    required
                  />
                </div>

                <div>
                  <label
                    for="registerEmail"
                    class="block text-sm font-medium text-gray-700 mb-2"
                  >
                    <i class="fas fa-envelope mr-2 text-green-600"></i>Email
                    Administrateur
                  </label>
                  <input
                    type="email"
                    id="registerEmail"
                    name="email"
                    class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 outline-none"
                    placeholder="admin@itsservice.com"
                    required
                  />
                </div>
              </div>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label
                    for="registerPassword"
                    class="block text-sm font-medium text-gray-700 mb-2"
                  >
                    <i class="fas fa-lock mr-2 text-green-600"></i>Mot de Passe
                  </label>
                  <div class="relative">
                    <input
                      type="password"
                      id="registerPassword"
                      name="password"
                      class="input-field w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 outline-none"
                      placeholder="••••••••"
                      required
                    />
                    <button
                      type="button"
                      onclick="togglePassword('registerPassword')"
                      class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700"
                    >
                      <i class="fas fa-eye"></i>
                    </button>
                  </div>
                  <p class="text-xs text-gray-500 mt-1">
                    <i class="fas fa-info-circle mr-1"></i>
                    Min. 8 caractères
                  </p>
                </div>

                <div>
                  <label
                    for="confirmPassword"
                    class="block text-sm font-medium text-gray-700 mb-2"
                  >
                    <i class="fas fa-check-double mr-2 text-green-600"></i
                    >Confirmer le Mot de Passe
                  </label>
                  <div class="relative">
                    <input
                      type="password"
                      id="registerConfirmPassword"
                      name="confirmPassword"
                      class="input-field w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 outline-none"
                      placeholder="••••••••"
                      required
                    />
                    <button
                      type="button"
                      onclick="togglePassword('registerConfirmPassword')"
                      class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700"
                    >
                      <i class="fas fa-eye"></i>
                    </button>
                  </div>
                </div>
              </div>

              <div>
                <label
                  for="adminCode"
                  class="block text-sm font-medium text-gray-700 mb-2"
                >
                  <i class="fas fa-key mr-2 text-green-600"></i>Code
                  Administrateur
                </label>
                <input
                  type="text"
                  id="adminCode"
                  name="adminCode"
                  class="input-field w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 outline-none"
                  placeholder="Code d'autorisation admin"
                  required
                />
                <p class="text-xs text-gray-500 mt-1">
                  <i class="fas fa-shield-alt mr-1"></i>
                  Code requis pour créer un compte administrateur
                </p>
              </div>

              <!-- Message d'erreur -->
              <div
                id="registerErrorMessage"
                class="hidden bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm"
              >
                <i class="fas fa-exclamation-triangle mr-2"></i>
                <span id="registerErrorText"></span>
              </div>

              <!-- Message de succès -->
              <div
                id="registerSuccessMessage"
                class="hidden bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg text-sm"
              >
                <i class="fas fa-check-circle mr-2"></i>
                <span id="registerSuccessText"></span>
              </div>

              <!-- Message de chargement -->
              <div
                id="registerLoadingMessage"
                class="hidden bg-blue-50 border border-blue-200 text-blue-700 px-4 py-3 rounded-lg text-sm"
              >
                <i class="fas fa-spinner fa-spin mr-2"></i>
                Création du compte administrateur...
              </div>

              <!-- Bouton d'inscription -->
              <button
                type="submit"
                id="registerButton"
                class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300 transform hover:scale-105 shadow-lg"
              >
                <i class="fas fa-user-plus mr-2"></i>
                Créer le Compte Administrateur
              </button>
            </form>
          </div>
          <!-- Fin de la colonne droite -->
        </div>
        <!-- Fin du conteneur flex principal -->
      </div>
      <!-- Footer -->
      <div class="mt-4 text-center">
        <p class="text-xs text-gray-500">
          <i class="fas fa-info-circle mr-1"></i>
          Accès réservé aux administrateurs autorisés
        </p>
        <div class="mt-2 flex justify-center space-x-4 text-xs text-gray-400">
          <span><i class="fas fa-shield-alt mr-1"></i>Sécurisé</span>
          <span><i class="fas fa-lock mr-1"></i>Crypté</span>
          <span><i class="fas fa-eye-slash mr-1"></i>Confidentiel</span>
        </div>
      </div>
    </div>

    <!-- Modale pour mot de passe oublié -->
    <div
      id="forgotPasswordModal"
      class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4"
    >
      <div
        class="bg-white rounded-xl shadow-2xl max-w-md w-full mx-4 transform transition-all"
      >
        <div
          class="bg-gradient-to-r from-blue-600 to-blue-700 text-white p-6 rounded-t-xl"
        >
          <div class="flex items-center justify-between">
            <div class="flex items-center">
              <i class="fas fa-key text-2xl mr-3"></i>
              <h3 class="text-xl font-bold">Récupération de mot de passe</h3>
            </div>
            <button
              onclick="closeForgotPasswordModal()"
              class="text-white hover:text-gray-200 transition-colors"
            >
              <i class="fas fa-times text-xl"></i>
            </button>
          </div>
          <p class="text-blue-100 text-sm mt-2">
            Entrez votre email pour recevoir un lien de réinitialisation
          </p>
        </div>

        <div class="p-6">
          <form id="forgotPasswordForm" class="space-y-4">
            <div>
              <label
                for="forgotEmail"
                class="block text-sm font-medium text-gray-700 mb-2"
              >
                <i class="fas fa-envelope mr-2 text-blue-600"></i>Adresse email
              </label>
              <input
                type="email"
                id="forgotEmail"
                name="email"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-colors"
                placeholder="votre.email@exemple.com"
                required
              />
            </div>

            <!-- Message d'erreur -->
            <div
              id="forgotErrorMessage"
              class="hidden bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm"
            >
              <i class="fas fa-exclamation-triangle mr-2"></i>
              <span id="forgotErrorText"></span>
            </div>

            <!-- Message de succès -->
            <div
              id="forgotSuccessMessage"
              class="hidden bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg text-sm"
            >
              <i class="fas fa-check-circle mr-2"></i>
              <span id="forgotSuccessText"></span>
            </div>

            <!-- Message de chargement -->
            <div
              id="forgotLoadingMessage"
              class="hidden bg-blue-50 border border-blue-200 text-blue-700 px-4 py-3 rounded-lg text-sm"
            >
              <i class="fas fa-spinner fa-spin mr-2"></i>
              Envoi de l'email en cours...
            </div>

            <div class="flex space-x-3">
              <button
                type="button"
                onclick="closeForgotPasswordModal()"
                class="flex-1 bg-gray-500 hover:bg-gray-600 text-white font-medium py-3 px-4 rounded-lg transition duration-300"
              >
                Annuler
              </button>
              <button
                type="submit"
                id="forgotPasswordButton"
                class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg transition duration-300"
              >
                <i class="fas fa-paper-plane mr-2"></i>
                Envoyer
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Modale pour réinitialisation avec token -->
    <div
      id="resetPasswordModal"
      class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4"
    >
      <div
        class="bg-white rounded-xl shadow-2xl max-w-md w-full mx-4 transform transition-all"
      >
        <div
          class="bg-gradient-to-r from-green-600 to-green-700 text-white p-6 rounded-t-xl"
        >
          <div class="flex items-center justify-between">
            <div class="flex items-center">
              <i class="fas fa-shield-alt text-2xl mr-3"></i>
              <h3 class="text-xl font-bold">Réinitialiser le mot de passe</h3>
            </div>
            <button
              onclick="closeResetPasswordModal()"
              class="text-white hover:text-gray-200 transition-colors"
            >
              <i class="fas fa-times text-xl"></i>
            </button>
          </div>
          <p class="text-green-100 text-sm mt-2">
            Entrez votre code de réinitialisation et votre nouveau mot de passe
          </p>
        </div>

        <div class="p-6">
          <form id="resetPasswordForm" class="space-y-4">
            <div>
              <label
                for="resetToken"
                class="block text-sm font-medium text-gray-700 mb-2"
              >
                <i class="fas fa-key mr-2 text-green-600"></i>Code de
                réinitialisation
              </label>
              <input
                type="text"
                id="resetToken"
                name="token"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 outline-none transition-colors font-mono"
                placeholder="Entrez le code reçu par email"
                required
              />
            </div>

            <div>
              <label
                for="newPassword"
                class="block text-sm font-medium text-gray-700 mb-2"
              >
                <i class="fas fa-lock mr-2 text-green-600"></i>Nouveau mot de
                passe
              </label>
              <input
                type="password"
                id="newPassword"
                name="newPassword"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 outline-none transition-colors"
                placeholder="Au moins 6 caractères"
                required
                minlength="6"
                oninput="checkPasswordMatch()"
              />
            </div>

            <div>
              <label
                for="confirmPassword"
                class="block text-sm font-medium text-gray-700 mb-2"
              >
                <i class="fas fa-lock mr-2 text-green-600"></i>Confirmer le mot
                de passe
              </label>
              <input
                type="password"
                id="confirmPassword"
                name="confirmPassword"
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 outline-none transition-colors"
                placeholder="Confirmez votre nouveau mot de passe"
                required
                minlength="6"
                oninput="checkPasswordMatch()"
              />
              <!-- Indicateur de correspondance des mots de passe -->
              <div id="passwordMatchIndicator" class="mt-2 text-sm hidden">
                <div id="passwordMatch" class="text-green-600 hidden">
                  <i class="fas fa-check-circle mr-1"></i>Les mots de passe
                  correspondent
                </div>
                <div id="passwordMismatch" class="text-red-600 hidden">
                  <i class="fas fa-times-circle mr-1"></i>Les mots de passe ne
                  correspondent pas
                </div>
              </div>
            </div>

            <!-- Message d'erreur -->
            <div
              id="resetErrorMessage"
              class="hidden bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm"
            >
              <i class="fas fa-exclamation-triangle mr-2"></i>
              <span id="resetErrorText"></span>
            </div>

            <!-- Message de succès -->
            <div
              id="resetSuccessMessage"
              class="hidden bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg text-sm"
            >
              <i class="fas fa-check-circle mr-2"></i>
              <span id="resetSuccessText"></span>
            </div>

            <!-- Message de chargement -->
            <div
              id="resetLoadingMessage"
              class="hidden bg-blue-50 border border-blue-200 text-blue-700 px-4 py-3 rounded-lg text-sm"
            >
              <i class="fas fa-spinner fa-spin mr-2"></i>
              Réinitialisation en cours...
            </div>

            <div class="flex space-x-3">
              <button
                type="button"
                onclick="closeResetPasswordModal()"
                class="flex-1 bg-gray-500 hover:bg-gray-600 text-white font-medium py-3 px-4 rounded-lg transition duration-300"
              >
                Annuler
              </button>
              <button
                type="submit"
                id="resetPasswordButton"
                class="flex-1 bg-green-600 hover:bg-green-700 text-white font-medium py-3 px-4 rounded-lg transition duration-300"
              >
                <i class="fas fa-save mr-2"></i>
                Réinitialiser
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <script>
      // Gestion du formulaire de connexion
      document
        .getElementById("adminLoginForm")
        .addEventListener("submit", async function (e) {
          e.preventDefault();

          const email = document.getElementById("adminEmail").value.trim();
          const password = document.getElementById("adminPassword").value;
          const errorDiv = document.getElementById("loginErrorMessage");
          const loadingDiv = document.getElementById("loginLoadingMessage");
          const loginButton = document.getElementById("loginButton");

          // Cacher les messages précédents
          errorDiv.classList.add("hidden");
          loadingDiv.classList.remove("hidden");
          loginButton.disabled = true;

          try {
            const response = await fetch("/api/admin-login", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({ email, password }),
            });

            const data = await response.json();

            if (response.ok && data.success && data.isAdmin) {
              // Connexion réussie
              localStorage.setItem("isAdminLoggedIn", "true");
              localStorage.setItem(
                "adminUser",
                JSON.stringify({
                  email: data.email,
                  name: data.name,
                  loginTime: new Date().toISOString(),
                })
              );

              // Redirection vers l'interface d'administration
              window.location.href = "/html/access-management.html";
            } else {
              // Erreur de connexion
              showError(data.message || "Email ou mot de passe incorrect");
            }
          } catch (error) {
            console.error("Erreur de connexion:", error);
            showError("Erreur de connexion au serveur");
          } finally {
            loadingDiv.classList.add("hidden");
            loginButton.disabled = false;
          }
        });

      // Gestion du formulaire d'inscription
      document
        .getElementById("adminRegisterForm")
        .addEventListener("submit", async function (e) {
          e.preventDefault();

          const registerButton = document.getElementById("registerButton");
          const loadingDiv = document.getElementById("registerLoadingMessage");
          const errorDiv = document.getElementById("registerErrorMessage");
          const successDiv = document.getElementById("registerSuccessMessage");

          // Cacher les messages précédents
          errorDiv.classList.add("hidden");
          successDiv.classList.add("hidden");

          // Vérifier que les mots de passe correspondent
          const password = document.getElementById("registerPassword").value;
          const confirmPassword = document.getElementById(
            "registerConfirmPassword"
          ).value;

          if (password !== confirmPassword) {
            showRegisterError("Les mots de passe ne correspondent pas");
            return;
          }

          // Vérifier la force du mot de passe
          if (password.length < 8) {
            showRegisterError(
              "Le mot de passe doit contenir au moins 8 caractères"
            );
            return;
          }

          loadingDiv.classList.remove("hidden");
          registerButton.disabled = true;

          const formData = {
            name: document.getElementById("registerName").value,
            email: document.getElementById("registerEmail").value,
            password: password,
            adminCode: document.getElementById("adminCode").value,
          };

          try {
            const response = await fetch("/api/admin-register", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify(formData),
            });

            const data = await response.json();

            if (data.success) {
              showRegisterSuccess(
                "Compte administrateur créé avec succès ! Vous pouvez maintenant vous connecter."
              );

              // Basculer vers l'onglet de connexion après 2 secondes
              setTimeout(() => {
                switchTab("login");
                document.getElementById("adminEmail").value = formData.email;
              }, 2000);
            } else {
              showRegisterError(
                data.message || "Erreur lors de la création du compte"
              );
            }
          } catch (error) {
            console.error("Erreur d'inscription:", error);
            showRegisterError("Erreur de connexion au serveur");
          } finally {
            loadingDiv.classList.add("hidden");
            registerButton.disabled = false;
          }
        });

      // Fonctions utilitaires
      function switchTab(tab) {
        const loginTab = document.getElementById("loginTab");
        const registerTab = document.getElementById("registerTab");
        const loginForm = document.getElementById("loginForm");
        const registerForm = document.getElementById("registerForm");

        if (tab === "login") {
          loginTab.classList.add("active");
          loginTab.classList.remove("text-gray-500", "border-transparent");
          loginTab.classList.add("text-blue-600", "border-blue-600");

          registerTab.classList.remove("active");
          registerTab.classList.remove("text-blue-600", "border-blue-600");
          registerTab.classList.add("text-gray-500", "border-transparent");

          loginForm.classList.remove("hidden");
          registerForm.classList.add("hidden");
        } else {
          registerTab.classList.add("active");
          registerTab.classList.remove("text-gray-500", "border-transparent");
          registerTab.classList.add("text-blue-600", "border-blue-600");

          loginTab.classList.remove("active");
          loginTab.classList.remove("text-blue-600", "border-blue-600");
          loginTab.classList.add("text-gray-500", "border-transparent");

          registerForm.classList.remove("hidden");
          loginForm.classList.add("hidden");
        }
      }

      function showRegisterError(message) {
        const errorDiv = document.getElementById("registerErrorMessage");
        const errorText = document.getElementById("registerErrorText");

        errorText.textContent = message;
        errorDiv.classList.remove("hidden");

        setTimeout(() => {
          errorDiv.classList.add("hidden");
        }, 5000);
      }

      function showRegisterSuccess(message) {
        const successDiv = document.getElementById("registerSuccessMessage");
        const successText = document.getElementById("registerSuccessText");

        successText.textContent = message;
        successDiv.classList.remove("hidden");

        setTimeout(() => {
          successDiv.classList.add("hidden");
        }, 5000);
      }

      function togglePassword(fieldId) {
        const passwordField = document.getElementById(fieldId);
        const icon = passwordField.nextElementSibling.querySelector("i");

        if (passwordField.type === "password") {
          passwordField.type = "text";
          icon.classList.remove("fa-eye");
          icon.classList.add("fa-eye-slash");
        } else {
          passwordField.type = "password";
          icon.classList.remove("fa-eye-slash");
          icon.classList.add("fa-eye");
        }
      }

      function showError(message) {
        const errorDiv = document.getElementById("loginErrorMessage");
        const errorText = document.getElementById("loginErrorText");

        errorText.textContent = message;
        errorDiv.classList.remove("hidden");

        // Faire disparaître le message après 5 secondes
        setTimeout(() => {
          errorDiv.classList.add("hidden");
        }, 5000);
      }

      function togglePassword(fieldId) {
        const passwordField = document.getElementById(fieldId);
        const icon = passwordField.nextElementSibling.querySelector("i");

        if (passwordField.type === "password") {
          passwordField.type = "text";
          icon.classList.remove("fa-eye");
          icon.classList.add("fa-eye-slash");
        } else {
          passwordField.type = "password";
          icon.classList.remove("fa-eye-slash");
          icon.classList.add("fa-eye");
        }
      }

      // Fonctions pour la récupération de mot de passe
      function showForgotPasswordModal() {
        const modal = document.getElementById("forgotPasswordModal");
        modal.classList.remove("hidden");
        document.body.style.overflow = "hidden";

        // Reset du formulaire
        document.getElementById("forgotPasswordForm").reset();
        document.getElementById("forgotErrorMessage").classList.add("hidden");
        document.getElementById("forgotSuccessMessage").classList.add("hidden");
        document.getElementById("forgotLoadingMessage").classList.add("hidden");
      }

      function closeForgotPasswordModal() {
        const modal = document.getElementById("forgotPasswordModal");
        modal.classList.add("hidden");
        document.body.style.overflow = "auto";
      }

      function showForgotError(message) {
        const errorDiv = document.getElementById("forgotErrorMessage");
        const errorText = document.getElementById("forgotErrorText");

        errorText.textContent = message;
        errorDiv.classList.remove("hidden");

        setTimeout(() => {
          errorDiv.classList.add("hidden");
        }, 5000);
      }

      function showForgotSuccess(message) {
        const successDiv = document.getElementById("forgotSuccessMessage");
        const successText = document.getElementById("forgotSuccessText");

        successText.textContent = message;
        successDiv.classList.remove("hidden");

        setTimeout(() => {
          successDiv.classList.add("hidden");
        }, 8000);
      }

      // Gestion du formulaire de récupération de mot de passe
      document
        .getElementById("forgotPasswordForm")
        .addEventListener("submit", async function (e) {
          e.preventDefault();

          const email = document.getElementById("forgotEmail").value.trim();
          const errorDiv = document.getElementById("forgotErrorMessage");
          const successDiv = document.getElementById("forgotSuccessMessage");
          const loadingDiv = document.getElementById("forgotLoadingMessage");
          const submitButton = document.getElementById("forgotPasswordButton");

          // Cacher les messages précédents
          errorDiv.classList.add("hidden");
          successDiv.classList.add("hidden");
          loadingDiv.classList.remove("hidden");
          submitButton.disabled = true;

          try {
            console.log("🔄 Envoi de la demande de récupération pour:", email);

            const response = await fetch("/api/admin-forgot-password", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({ email }),
            });

            const data = await response.json();
            console.log("📧 Réponse serveur:", data);

            if (response.ok) {
              showForgotSuccess(
                "Un email de récupération a été envoyé à votre adresse. Vérifiez votre boîte de réception et vos spams."
              );

              // Fermer la modale après 3 secondes
              setTimeout(() => {
                closeForgotPasswordModal();
              }, 3000);
            } else {
              showForgotError(
                data.message ||
                  "Erreur lors de l'envoi de l'email de récupération"
              );
            }
          } catch (error) {
            console.error("❌ Erreur:", error);
            showForgotError("Erreur de connexion. Veuillez réessayer.");
          } finally {
            loadingDiv.classList.add("hidden");
            submitButton.disabled = false;
          }
        });

      // Fonction pour vérifier la correspondance des mots de passe en temps réel
      function checkPasswordMatch() {
        const newPassword = document.getElementById("newPassword").value;
        const confirmPassword =
          document.getElementById("confirmPassword").value;
        const indicator = document.getElementById("passwordMatchIndicator");
        const matchDiv = document.getElementById("passwordMatch");
        const mismatchDiv = document.getElementById("passwordMismatch");

        // Si les deux champs sont vides, cacher l'indicateur
        if (!newPassword && !confirmPassword) {
          indicator.classList.add("hidden");
          return;
        }

        // Si un seul champ est rempli, ne pas montrer d'indicateur
        if (!newPassword || !confirmPassword) {
          indicator.classList.add("hidden");
          return;
        }

        // Montrer l'indicateur
        indicator.classList.remove("hidden");

        // Vérifier si les mots de passe correspondent
        if (newPassword === confirmPassword) {
          matchDiv.classList.remove("hidden");
          mismatchDiv.classList.add("hidden");
        } else {
          matchDiv.classList.add("hidden");
          mismatchDiv.classList.remove("hidden");
        }
      }

      // Fermer la modale en cliquant à l'extérieur
      document
        .getElementById("forgotPasswordModal")
        .addEventListener("click", function (e) {
          if (e.target === this) {
            closeForgotPasswordModal();
          }
        });

      // Fonctions pour la modal de réinitialisation de mot de passe
      function showResetPasswordModal() {
        const modal = document.getElementById("resetPasswordModal");
        modal.classList.remove("hidden");
        document.body.style.overflow = "hidden";

        // Reset du formulaire
        document.getElementById("resetPasswordForm").reset();
        document.getElementById("resetErrorMessage").classList.add("hidden");
        document.getElementById("resetSuccessMessage").classList.add("hidden");
        document.getElementById("resetLoadingMessage").classList.add("hidden");

        // Focus sur le champ token
        setTimeout(() => {
          document.getElementById("resetToken").focus();
        }, 100);
      }

      function closeResetPasswordModal() {
        const modal = document.getElementById("resetPasswordModal");
        modal.classList.add("hidden");
        document.body.style.overflow = "auto";
      }

      function showResetError(message) {
        const errorDiv = document.getElementById("resetErrorMessage");
        const errorText = document.getElementById("resetErrorText");

        errorText.textContent = message;
        errorDiv.classList.remove("hidden");

        setTimeout(() => {
          errorDiv.classList.add("hidden");
        }, 5000);
      }

      function showResetSuccess(message) {
        const successDiv = document.getElementById("resetSuccessMessage");
        const successText = document.getElementById("resetSuccessText");

        successText.textContent = message;
        successDiv.classList.remove("hidden");

        setTimeout(() => {
          successDiv.classList.add("hidden");
        }, 8000);
      }

      // Gestion du formulaire de réinitialisation de mot de passe
      document
        .getElementById("resetPasswordForm")
        .addEventListener("submit", async function (e) {
          e.preventDefault();

          const token = document.getElementById("resetToken").value.trim();
          const newPassword = document.getElementById("newPassword").value;
          const confirmPassword =
            document.getElementById("confirmPassword").value;

          // Validation des mots de passe
          if (newPassword !== confirmPassword) {
            showResetError("Les mots de passe ne correspondent pas");
            return;
          }

          if (newPassword.length < 6) {
            showResetError(
              "Le mot de passe doit contenir au moins 6 caractères"
            );
            return;
          }

          const errorDiv = document.getElementById("resetErrorMessage");
          const successDiv = document.getElementById("resetSuccessMessage");
          const loadingDiv = document.getElementById("resetLoadingMessage");
          const submitButton = document.getElementById("resetPasswordButton");

          // Cacher les messages précédents
          errorDiv.classList.add("hidden");
          successDiv.classList.add("hidden");
          loadingDiv.classList.remove("hidden");
          submitButton.disabled = true;

          try {
            console.log("🔄 Envoi de la demande de réinitialisation");

            const response = await fetch("/api/admin-reset-password", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({
                token: token,
                newPassword: newPassword,
              }),
            });

            const data = await response.json();
            console.log("🔐 Réponse serveur:", data);

            if (response.ok) {
              showResetSuccess(
                "Mot de passe réinitialisé avec succès ! Vous pouvez maintenant vous connecter."
              );

              // Fermer la modale après 3 secondes et revenir à la connexion
              setTimeout(() => {
                closeResetPasswordModal();
                // Optionnel : focus sur le formulaire de connexion
                const loginEmailField = document.getElementById("loginEmail");
                if (loginEmailField) {
                  loginEmailField.focus();
                }
              }, 3000);
            } else {
              showResetError(
                data.message ||
                  "Erreur lors de la réinitialisation du mot de passe"
              );
            }
          } catch (error) {
            console.error("❌ Erreur:", error);
            showResetError("Erreur de connexion. Veuillez réessayer.");
          } finally {
            loadingDiv.classList.add("hidden");
            submitButton.disabled = false;
          }
        });

      // Fermer la modale de réinitialisation en cliquant à l'extérieur
      document
        .getElementById("resetPasswordModal")
        .addEventListener("click", function (e) {
          if (e.target === this) {
            closeResetPasswordModal();
          }
        });

      // Vérifier si l'utilisateur est déjà connecté
      document.addEventListener("DOMContentLoaded", function () {
        const isAdminLoggedIn = localStorage.getItem("isAdminLoggedIn");
        if (isAdminLoggedIn === "true") {
          window.location.href = "/html/access-management.html";
          return;
        }

        // Vérifier si l'URL contient un token de réinitialisation
        const urlParams = new URLSearchParams(window.location.search);
        const resetToken = urlParams.get("reset");

        if (resetToken) {
          // Ouvrir automatiquement la modal de réinitialisation et pré-remplir le token
          setTimeout(() => {
            showResetPasswordModal();
            document.getElementById("resetToken").value = resetToken;
            // Focus sur le champ nouveau mot de passe
            document.getElementById("newPassword").focus();
          }, 500);
        }
      });
    </script>
  </body>
</html>
